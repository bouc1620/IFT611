<html>

<body>
  <script src="wasm/data-module.js"></script>
  <script>
    function cArray_i32(size) {
      const offset = Module._malloc(size << 2);
      Module.HEAP32.set(new Int32Array(size), (offset >> 2));
      return {
        array: Module.HEAP32.subarray((offset >> 2), (offset >> 2) + size),
        offset
      }
    }

    Module.onRuntimeInitialized = function () {
      const array = cArray_i32(1000);

      const instance = new Module.Document(1, array.offset);
      const text = "It works!\nHello, World! From WebAssembly module";

      for (let i = 0; i < text.length; ++i) {
        instance.insert_fromLocal(text[i].charCodeAt(0), i);
      }

      instance.printDocument();
    }
  </script>
</body>

<html>